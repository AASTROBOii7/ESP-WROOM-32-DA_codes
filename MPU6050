#include <Wire.h>

const int MPU_ADDR = 0x68; // I2C address of the MPU-6050
int16_t AcX, AcY, AcZ, Tmp, GyX, GyY, GyZ;

void setup() {
  Serial.begin(115200);
  Wire.begin(21, 22); // SDA on 21, SCL on 22
  
  // Wake up the MPU6050 (it starts in sleep mode)
  Wire.beginTransmission(MPU_ADDR);
  Wire.write(0x6B); // PWR_MGMT_1 register
  Wire.write(0);    // set to zero (wakes up the MPU-6050)
  byte status = Wire.endTransmission(true);

  if (status == 0) {
    Serial.println("MPU6050 Woken Up Successfully!");
  } else {
    Serial.print("Connection Failed. Wire Status: ");
    Serial.println(status);
  }
}

void loop() {
  Wire.beginTransmission(MPU_ADDR);
  Wire.write(0x3B); // starting with register 0x3B (ACCEL_XOUT_H)
  Wire.endTransmission(false);
  Wire.requestFrom(MPU_ADDR, 14, true); // request a total of 14 registers

  // Read Accelerometer
  AcX = Wire.read() << 8 | Wire.read(); 
  AcY = Wire.read() << 8 | Wire.read(); 
  AcZ = Wire.read() << 8 | Wire.read(); 
  // Read Temperature
  Tmp = Wire.read() << 8 | Wire.read(); 
  // Read Gyroscope
  GyX = Wire.read() << 8 | Wire.read(); 
  GyY = Wire.read() << 8 | Wire.read(); 
  GyZ = Wire.read() << 8 | Wire.read(); 

  Serial.print("Accel: "); Serial.print(AcX); Serial.print(", "); Serial.print(AcY); Serial.print(", "); Serial.print(AcZ);
  Serial.print(" | Temp: "); Serial.print(Tmp / 340.00 + 36.53); // Formula from datasheet
  Serial.print(" | Gyro: "); Serial.print(GyX); Serial.print(", "); Serial.print(GyY); Serial.println(", "); Serial.print(GyZ);

  delay(500);
}
